plot_data_occupancy_depth <- data.frame(
depth = rep(depth_pred_seq, each = n.post.new),
occupancy = as.vector(occupancy_pred)
)
# Volume effect on capture
vol_pred_seq <- seq(from = min(as.numeric(biosamp_dat$Volume_filt_mL)),
to = max(as.numeric(biosamp_dat$Volume_filt_mL)),
length.out = 100)
vol_pred_centered <- vol_pred_seq - mean(as.numeric(biosamp_dat$Volume_filt_mL))
capture_pred_vol <- matrix(NA, n.post.new, length(vol_pred_seq))
for (i in 1:length(vol_pred_seq)) {
for (j in 1:n.post.new) {
capture_pred_vol[j, i] <- inv.logit(cap_prob_hat[j] +
b_vol[j] * vol_pred_centered[i])
}
}
plot_data_capture_vol <- data.frame(
volume = rep(vol_pred_seq, each = n.post.new),
capture = as.vector(capture_pred_vol)
)
# Method comparison
gemcap_capture_new <- as.numeric(inv.logit(cap_prob_hat))
rreas_capture_new <- as.numeric(inv.logit(cap_prob_hat + b_meth[,2]))
ncog_capture_new <- as.numeric(inv.logit(cap_prob_hat + b_meth[,3]))
df_methods_new <- data.frame(
GEMCAP = gemcap_capture_new,
RREAS = rreas_capture_new,
NCOG = ncog_capture_new
) %>%
pivot_longer(cols = everything(),
names_to = "Method",
values_to = "Probability")
# Detection comparison
df_detection_new <- data.frame(
Probability = c(prob_detection[, 1], prob_detection[, 2]),
Method = rep(c("d-loop", "MiFish"), each = nrow(prob_detection))
)
# Create 4-panel plot for site x depth model
p1_new <- ggplot(plot_data_occupancy_depth,
aes(x = depth, y = occupancy)) +
stat_lineribbon(alpha = 0.25, fill = "#4CAF50", color = "#2E7D32",
.width = c(0.25, 0.5, 0.75)) +
labs(x = "Depth (m)", y = "Probability of Occupancy", title = "Site x Depth: Depth Effect on Occupancy") +
theme_minimal()
p2_new <- ggplot(plot_data_capture_vol,
aes(x = volume, y = capture)) +
stat_lineribbon(alpha = 0.25, fill = "#FF9800", color = "#F57C00",
.width = c(0.25, 0.5, 0.75)) +
labs(x = "Volume Filtered (mL)", y = "Probability of Capture", title = "Site x Depth: Volume Effect on Capture") +
theme_minimal()
p3_new <- ggplot(df_methods_new,
aes(x = Probability, fill = Method, color = Method)) +
geom_histogram(aes(y = after_stat(density)),
alpha = 0.3, position = "identity", bins = 30) +
geom_density(size = 1.2) +
scale_fill_viridis(discrete = TRUE, alpha = 0.3,
begin = 0.3, end = 0.7) +
scale_color_viridis(discrete = TRUE,
begin = 0.3, end = 0.7) +
labs(x = "Capture Probability",
y = "Density",
title = "Site x Depth: RREAS vs. GEMCAP") +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
p3_new
p3_new <- ggplot(df_methods_new,
aes(x = Probability, fill = Method, color = Method)) +
geom_histogram(aes(y = after_stat(density)),
alpha = 0.3, position = "identity", bins = 30) +
geom_density(size = 1.2) +
scale_fill_brewer(palette = "Set1", alpha = 0.3) +
scale_color_brewer(palette = "Set1", alpha = 0.3) +
# scale_fill_viridis(discrete = TRUE, alpha = 0.3,
#                 begin = 0.3, end = 0.7) +
# scale_color_viridis(discrete = TRUE,
#                  begin = 0.3, end = 0.7) +
labs(x = "Capture Probability",
y = "Density",
title = "Site x Depth: RREAS vs. GEMCAP") +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
p3_new <- ggplot(df_methods_new,
aes(x = Probability, fill = Method,
color = Method, alpha = 0.3)) +
geom_histogram(aes(y = after_stat(density)),
alpha = 0.3, position = "identity", bins = 30) +
geom_density(size = 1.2) +
scale_fill_brewer(palette = "Set1", ) +
scale_color_brewer(palette = "Set1") +
# scale_fill_viridis(discrete = TRUE, alpha = 0.3,
#                 begin = 0.3, end = 0.7) +
# scale_color_viridis(discrete = TRUE,
#                  begin = 0.3, end = 0.7) +
labs(x = "Capture Probability",
y = "Density",
title = "Site x Depth: RREAS vs. GEMCAP") +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
p3_new
p3_new <- ggplot(df_methods_new,
aes(x = Probability, fill = Method,
color = Method)) +
geom_histogram(aes(y = after_stat(density)),
alpha = 0.3, position = "identity", bins = 30) +
geom_density(size = 1.2) +
scale_fill_brewer(palette = "Set1", ) +
scale_color_brewer(palette = "Set1") +
# scale_fill_viridis(discrete = TRUE, alpha = 0.3,
#                 begin = 0.3, end = 0.7) +
# scale_color_viridis(discrete = TRUE,
#                  begin = 0.3, end = 0.7) +
labs(x = "Capture Probability",
y = "Density",
title = "Site x Depth: RREAS vs. GEMCAP") +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
p3_new
p3_new <- ggplot(df_methods_new,
aes(x = Probability, fill = Method,
color = Method, alpha = 0.3)) +
geom_histogram(aes(y = after_stat(density)),
position = "identity", bins = 30) +
geom_density(size = 1.2) +
scale_fill_brewer(palette = "Set1", ) +
scale_color_brewer(palette = "Set1") +
# scale_fill_viridis(discrete = TRUE, alpha = 0.3,
#                 begin = 0.3, end = 0.7) +
# scale_color_viridis(discrete = TRUE,
#                  begin = 0.3, end = 0.7) +
labs(x = "Capture Probability",
y = "Density",
title = "Site x Depth: RREAS vs. GEMCAP") +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
p3_new
p3_new <- ggplot(df_methods_new,
aes(x = Probability, fill = Method,
color = Method, alpha = 0.3)) +
geom_histogram(aes(y = after_stat(density), alpha = 0.3),
position = "identity", bins = 30) +
geom_density(size = 1.2) +
scale_fill_brewer(palette = "Set1", ) +
scale_color_brewer(palette = "Set1") +
# scale_fill_viridis(discrete = TRUE, alpha = 0.3,
#                 begin = 0.3, end = 0.7) +
# scale_color_viridis(discrete = TRUE,
#                  begin = 0.3, end = 0.7) +
labs(x = "Capture Probability",
y = "Density",
title = "Site x Depth: RREAS vs. GEMCAP") +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
p3_new
p3_new <- ggplot(df_methods_new,
aes(x = Probability, fill = Method,
color = Method, alpha = 0.3)) +
geom_histogram(aes(y = after_stat(density)),
position = "identity", bins = 30) +
geom_density(size = 1.2, alpha = 0.3) +
scale_fill_brewer(palette = "Set1", ) +
scale_color_brewer(palette = "Set1") +
# scale_fill_viridis(discrete = TRUE, alpha = 0.3,
#                 begin = 0.3, end = 0.7) +
# scale_color_viridis(discrete = TRUE,
#                  begin = 0.3, end = 0.7) +
labs(x = "Capture Probability",
y = "Density",
title = "Site x Depth: RREAS vs. GEMCAP") +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
p3_new
p3_new <- ggplot(df_methods_new,
aes(x = Probability, fill = Method,
color = Method)) +
geom_histogram(aes(y = after_stat(density)),
position = "identity", bins = 30) +
geom_density(size = 1.2, alpha = 0.3) +
scale_fill_brewer(palette = "Set1", ) +
scale_color_brewer(palette = "Set1") +
# scale_fill_viridis(discrete = TRUE, alpha = 0.3,
#                 begin = 0.3, end = 0.7) +
# scale_color_viridis(discrete = TRUE,
#                  begin = 0.3, end = 0.7) +
labs(x = "Capture Probability",
y = "Density",
title = "Site x Depth: RREAS vs. GEMCAP") +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
p3_new
p3_new <- ggplot(df_methods_new,
aes(x = Probability, fill = Method,
color = Method)) +
geom_histogram(aes(y = after_stat(density)),
position = "identity", bins = 30) +
geom_density(size = 1.2, alpha = 0.3) +
scale_fill_brewer(palette = "Set1", ) +
scale_color_brewer(palette = "Set1") +
# scale_fill_viridis(discrete = TRUE, alpha = 0.3,
#                 begin = 0.3, end = 0.7) +
# scale_color_viridis(discrete = TRUE,
#                  begin = 0.3, end = 0.7) +
labs(x = "Capture Probability",
y = "Density",
title = "Site x Depth: RREAS vs. GEMCAP") +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
p3_new
p3_new <- ggplot(df_methods_new,
aes(x = Probability, fill = Method,
color = Method)) +
geom_histogram(aes(y = after_stat(density)),
position = "identity", bins = 30, alpha = 0.3) +
geom_density(size = 1.2, alpha = 0.3) +
scale_fill_brewer(palette = "Set1", ) +
scale_color_brewer(palette = "Set1") +
# scale_fill_viridis(discrete = TRUE, alpha = 0.3,
#                 begin = 0.3, end = 0.7) +
# scale_color_viridis(discrete = TRUE,
#                  begin = 0.3, end = 0.7) +
labs(x = "Capture Probability",
y = "Density",
title = "Site x Depth: RREAS vs. GEMCAP") +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
p3_new
p3_new <- ggplot(df_methods_new,
aes(x = Probability, fill = Method,
color = Method)) +
geom_histogram(aes(y = after_stat(density)),
position = "identity", bins = 30, alpha = 0.3) +
geom_density(size = 1.2, alpha = 0.3) +
scale_fill_okabeito(palette = "full", ) +
scale_color_okabeito(palette = "full") +
# scale_fill_viridis(discrete = TRUE, alpha = 0.3,
#                 begin = 0.3, end = 0.7) +
# scale_color_viridis(discrete = TRUE,
#                  begin = 0.3, end = 0.7) +
labs(x = "Capture Probability",
y = "Density",
title = "Site x Depth: RREAS vs. GEMCAP") +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
p3_new <- ggplot(df_methods_new,
aes(x = Probability, fill = Method,
color = Method)) +
geom_histogram(aes(y = after_stat(density)),
position = "identity", bins = 30, alpha = 0.3) +
geom_density(size = 1.2, alpha = 0.3) +
scale_fill_oi(palette = "full", ) +
scale_color_oi(palette = "full") +
# scale_fill_viridis(discrete = TRUE, alpha = 0.3,
#                 begin = 0.3, end = 0.7) +
# scale_color_viridis(discrete = TRUE,
#                  begin = 0.3, end = 0.7) +
labs(x = "Capture Probability",
y = "Density",
title = "Site x Depth: RREAS vs. GEMCAP") +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
install.packages("ggokabeito")
library(okabeito)
library(ggokabeito)
p3_new <- ggplot(df_methods_new,
aes(x = Probability, fill = Method,
color = Method)) +
geom_histogram(aes(y = after_stat(density)),
position = "identity", bins = 30, alpha = 0.3) +
geom_density(size = 1.2, alpha = 0.3) +
scale_fill_oi(palette = "full", ) +
scale_color_oi(palette = "full") +
# scale_fill_viridis(discrete = TRUE, alpha = 0.3,
#                 begin = 0.3, end = 0.7) +
# scale_color_viridis(discrete = TRUE,
#                  begin = 0.3, end = 0.7) +
labs(x = "Capture Probability",
y = "Density",
title = "Site x Depth: RREAS vs. GEMCAP") +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
p3_new <- ggplot(df_methods_new,
aes(x = Probability, fill = Method,
color = Method)) +
geom_histogram(aes(y = after_stat(density)),
position = "identity", bins = 30, alpha = 0.3) +
geom_density(size = 1.2, alpha = 0.3) +
scale_fill_okabeito(palette = "full", ) +
scale_color_okabeito(palette = "full") +
# scale_fill_viridis(discrete = TRUE, alpha = 0.3,
#                 begin = 0.3, end = 0.7) +
# scale_color_viridis(discrete = TRUE,
#                  begin = 0.3, end = 0.7) +
labs(x = "Capture Probability",
y = "Density",
title = "Site x Depth: RREAS vs. GEMCAP") +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
p3_new <- ggplot(df_methods_new,
aes(x = Probability, fill = Method,
color = Method)) +
geom_histogram(aes(y = after_stat(density)),
position = "identity", bins = 30, alpha = 0.3) +
geom_density(size = 1.2, alpha = 0.3) +
scale_fill_okabe_ito(palette = "full", ) +
scale_color_okabe_ito(palette = "full") +
# scale_fill_viridis(discrete = TRUE, alpha = 0.3,
#                 begin = 0.3, end = 0.7) +
# scale_color_viridis(discrete = TRUE,
#                  begin = 0.3, end = 0.7) +
labs(x = "Capture Probability",
y = "Density",
title = "Site x Depth: RREAS vs. GEMCAP") +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
p3_new <- ggplot(df_methods_new,
aes(x = Probability, fill = Method,
color = Method)) +
geom_histogram(aes(y = after_stat(density)),
position = "identity", bins = 30, alpha = 0.3) +
geom_density(size = 1.2, alpha = 0.3) +
scale_fill_okabe_ito(palette = "full") +
scale_color_okabe_ito(palette = "full") +
# scale_fill_viridis(discrete = TRUE, alpha = 0.3,
#                 begin = 0.3, end = 0.7) +
# scale_color_viridis(discrete = TRUE,
#                  begin = 0.3, end = 0.7) +
labs(x = "Capture Probability",
y = "Density",
title = "Site x Depth: RREAS vs. GEMCAP") +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
p3_new <- ggplot(df_methods_new,
aes(x = Probability, fill = Method,
color = Method)) +
geom_histogram(aes(y = after_stat(density)),
position = "identity", bins = 30, alpha = 0.3) +
geom_density(size = 1.2, alpha = 0.3) +
scale_fill_okabe_ito() +
scale_color_okabe_ito() +
# scale_fill_viridis(discrete = TRUE, alpha = 0.3,
#                 begin = 0.3, end = 0.7) +
# scale_color_viridis(discrete = TRUE,
#                  begin = 0.3, end = 0.7) +
labs(x = "Capture Probability",
y = "Density",
title = "Site x Depth: RREAS vs. GEMCAP") +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
p3_new
# Create 4-panel plot for site x depth model
p1_new <- ggplot(plot_data_occupancy_depth,
aes(x = depth, y = occupancy)) +
stat_lineribbon(alpha = 0.25, fill = "#4CAF50", color = "#2E7D32",
.width = c(0.25, 0.5, 0.75)) +
labs(x = "Depth (m)", y = "Probability of Occupancy", title = "Site x Depth: Depth Effect on Occupancy") +
theme_minimal()
p2_new <- ggplot(plot_data_capture_vol,
aes(x = volume, y = capture)) +
stat_lineribbon(alpha = 0.25, fill = "#FF9800", color = "#F57C00",
.width = c(0.25, 0.5, 0.75)) +
labs(x = "Volume Filtered (mL)", y = "Probability of Capture", title = "Site x Depth: Volume Effect on Capture") +
theme_minimal()
p4_new <- ggplot(df_detection_new,
aes(x = Probability, fill = Method, color = Method)) +
geom_histogram(aes(y = after_stat(density)),
alpha = 0.3, position = "identity", bins = 30) +
geom_density(size = 1.2) +
scale_fill_viridis(discrete = TRUE, alpha = 0.3, begin = 0.3, end = 0.7) +
scale_color_viridis(discrete = TRUE, begin = 0.3, end = 0.7) +
labs(x = "Detection Probability", y = "Density", title = "Site x Depth: Dloop vs. MiFish") +
theme_bw() + theme(panel.grid = element_blank(), legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
p1_new
# Create 4-panel plot for site x depth model
p1_new <- ggplot(plot_data_occupancy_depth,
aes(x = depth, y = occupancy)) +
stat_lineribbon(alpha = 0.25, fill = "#4CAF50", color = "#2E7D32",
.width = c(0.25, 0.5, 0.75)) +
labs(x = "Depth (m)", y = "Probability of Occupancy", title = "Site x Depth: Depth Effect on Occupancy") +
theme_bw()
p1_new
# Create 4-panel plot for site x depth model
p1_new <- ggplot(plot_data_occupancy_depth,
aes(x = depth, y = occupancy)) +
stat_lineribbon(alpha = 0.25, fill = "#4CAF50", color = "#2E7D32",
.width = c(0.25, 0.5, 0.75)) +
labs(x = "Depth (m)", y = "Probability of Occupancy", title = "Site x Depth: Depth Effect on Occupancy") +
theme_minimal()
p1_new
p2_new
p3_newq
p3_new
p4_new
p4_new <- ggplot(df_detection_new,
aes(x = Probability, fill = Method, color = Method)) +
geom_histogram(aes(y = after_stat(density)),
alpha = 0.3, position = "identity", bins = 30) +
geom_density(size = 1.2) +
scale_fill_viridis(discrete = TRUE, alpha = 0.3, begin = 0.3, end = 0.7) +
scale_color_viridis(discrete = TRUE, begin = 0.3, end = 0.7) +
labs(x = "Detection Probability", y = "Density",
title = "Site x Depth: D-loop vs. MiFish") +
theme_bw() + theme(panel.grid = element_blank(), legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
p4_new
p4_new <- ggplot(df_detection_new,
aes(x = Probability, fill = Method, color = Method)) +
geom_histogram(aes(y = after_stat(density)),
alpha = 0.3, position = "identity", bins = 30) +
geom_density(size = 1.2) +
scale_fill_viridis(discrete = TRUE, alpha = 0.3, begin = 0.3, end = 0.7) +
scale_color_viridis(discrete = TRUE, begin = 0.3, end = 0.7) +
labs(x = "Detection Probability", y = "Density",
title = "Site x Depth: d-loop vs. MiFish") +
theme_bw() + theme(panel.grid = element_blank(), legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
p4_new
sitedepth_2panel <- p2_new / p3_new
sitedepth_2panel
p2_new <- ggplot(plot_data_capture_vol,
aes(x = volume, y = capture)) +
stat_lineribbon(alpha = 0.25, fill = "#EE7AE9", color = "#DA70D6",
.width = c(0.25, 0.5, 0.75)) +
labs(x = "Volume Filtered (mL)", y = "Probability of Capture",
title = "Site x Depth: Volume Effect on Capture") +
theme_minimal()
sitedepth_2panel <- p2_new / p3_new
sitedepth_2panel
p3_new <- ggplot(df_methods_new,
aes(x = Probability, fill = Method,
color = Method)) +
geom_histogram(aes(y = after_stat(density)),
position = "identity", bins = 30, alpha = 0.3) +
geom_density(size = 1.2, alpha = 0.3) +
scale_fill_okabe_ito() +
scale_color_okabe_ito() +
labs(x = "Capture Probability",
y = "Density",
title = "Site x Depth: RREAS vs. GEMCAP vs. NCOG") +
theme_bw() +
theme(panel.grid = element_blank(),
legend.position = "bottom") +
scale_x_continuous(limits = c(0, 1))
sitedepth_2panel <- p2_new / p3_new
sitedepth_2panel
setwd("/Users/nastassiapatin/GitHub/eDNA_patch/Data")
library(tidyverse)
mfu <- read.csv("intercal_MFU_taxon_table_wide-cetaceans.csv")
View(mfu)
mfu <- read.csv("intercal_MFU_taxon_table_wide-cetaceans.csv")
View(mfu)
mfu <- read.csv("intercal_MFU_taxon_table_wide-cetaceans.csv")
View(mfu)
mfu <- read.csv("intercal_MFU_taxon_table_wide-cetaceans.csv")
mfu <- read.csv("intercal_MFU_taxon_table_wide-cetaceans.csv")
View(mfu)
?widee_to_long
?wide_to_long
mfu_long <- mfu %>% pivot_longer(!BestTaxon, names_to = "SampleID")
View(mfu_long)
mfu_long <- mfu %>% pivot_longer(!BestTaxon, names_to = "SampleID", values_to="Reads")
View(mfu_long)
mfu_long['Marker'] <- 'MiFish'
dl <- read.csv("intercal_DL_taxon_table_wide-cetaceans.csv")
dl_long <- dl %>% pivot_longer(!BestTaxon, names_to = "SampleID", values_to="Reads")
dl_long['Marker'] <- 'd-loop'
View(mfu_long)
View(dl_long)
cets_all <- rbind(mfu_long, dl_long)
View(cets_all)
write.csv(cets_all, "intercal_cetacean_detections.csvs")
write.csv(cets_all, "intercal_cetacean_detections.csv")
View(dl)
dl <- read.csv("intercal_DL_taxon_table_wide-cetaceans.csv")
dl_long <- dl %>% pivot_longer(!BestTaxon, names_to = "SampleID", values_to="Reads")
dl_long['Marker'] <- 'd-loop'
cets_all <- rbind(mfu_long, dl_long)
write.csv(cets_all, "intercal_cetacean_detections.csv")
View(dl)
